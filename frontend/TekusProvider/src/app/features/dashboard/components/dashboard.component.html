<div class="dashboard-container">
  <div class="dashboard-header">
    <h1 class="dashboard-title">Dashboard de Estad√≠sticas</h1>
    <button class="refresh-button" (click)="refresh()" [disabled]="loading()">
      <span class="refresh-icon">‚Üª</span>
      Actualizar
    </button>
  </div>

  @if (loading()) {
    <div class="loading-container">
      <div class="spinner"></div>
      <p>Cargando estad√≠sticas...</p>
    </div>
  }

  @if (error()) {
    <div class="error-container">
      <p class="error-message">{{ error() }}</p>
      <button class="retry-button" (click)="refresh()">Reintentar</button>
    </div>
  }

  @if (summaryReport() && !loading()) {
    <div class="stats-grid">
      <!-- Tarjetas de estad√≠sticas principales -->
      <div class="stat-card stat-card-primary">
        <div class="stat-icon">üë•</div>
        <div class="stat-content">
          <h3 class="stat-title">Total Proveedores</h3>
          <p class="stat-value">{{ summaryReport()!.totalProviders }}</p>
        </div>
      </div>

      <div class="stat-card stat-card-success">
        <div class="stat-icon">üîß</div>
        <div class="stat-content">
          <h3 class="stat-title">Total Servicios</h3>
          <p class="stat-value">{{ summaryReport()!.totalServices }}</p>
        </div>
      </div>

      <div class="stat-card stat-card-info">
        <div class="stat-icon">üåç</div>
        <div class="stat-content">
          <h3 class="stat-title">Pa√≠ses</h3>
          <p class="stat-value">{{ summaryReport()!.totalCountriesCovered }}</p>
        </div>
      </div>

      <div class="stat-card stat-card-warning">
        <div class="stat-icon">üí∞</div>
        <div class="stat-content">
          <h3 class="stat-title">Tarifa Promedio</h3>
          <p class="stat-value">${{ summaryReport()!.averageHourlyRate.toFixed(2) }}</p>
          <p class="stat-subtitle">por hora</p>
        </div>
      </div>
    </div>

    <!-- Servicios m√°s caros y baratos -->
    <div class="price-comparison">
      @if (summaryReport()!.mostExpensiveService) {
        <div class="price-card price-card-expensive">
          <h3 class="price-card-title">üîù Servicio M√°s Caro</h3>
          <div class="price-card-content">
            <p class="service-name">{{ summaryReport()!.mostExpensiveService!.name }}</p>
            <p class="provider-name">Proveedor: {{ summaryReport()!.mostExpensiveService!.providerName }}</p>
            <p class="price-value">${{ summaryReport()!.mostExpensiveService!.hourlyRate.toFixed(2) }}/hora</p>
          </div>
        </div>
      }

      @if (summaryReport()!.cheapestService) {
        <div class="price-card price-card-cheap">
          <h3 class="price-card-title">üíé Servicio M√°s Econ√≥mico</h3>
          <div class="price-card-content">
            <p class="service-name">{{ summaryReport()!.cheapestService!.name }}</p>
            <p class="provider-name">Proveedor: {{ summaryReport()!.cheapestService!.providerName }}</p>
            <p class="price-value">${{ summaryReport()!.cheapestService!.hourlyRate.toFixed(2) }}/hora</p>
          </div>
        </div>
      }
    </div>

    <!-- Estad√≠sticas por pa√≠s -->
    <div class="country-stats">
      <h2 class="section-title">Estad√≠sticas por Pa√≠s</h2>
      <div class="country-grid">
        @for (stat of summaryReport()!.countryStatistics; track stat.countryCode) {
          <div class="country-card">
            <h3 class="country-name">üåç {{ stat.countryName }}</h3>
            <div class="country-stat-row">
              <span class="country-stat-label">üë• Proveedores:</span>
              <span class="country-stat-value">{{ stat.providersCount }}</span>
            </div>
            <div class="country-stat-row">
              <span class="country-stat-label">üîß Servicios:</span>
              <span class="country-stat-value">{{ stat.servicesCount }}</span>
            </div>
          </div>
        }
      </div>
    </div>
  }
</div>

